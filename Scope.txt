St. Joseph's List

## Statement

A community-based tool-sharing website. The idea is to allow users to share tools they own within small, real-world communities that they are a part of. Users can be invited to join specific "groups" and create tool listings that are shown only to other members of the groups that they belong to. 

The following needs to be supported: 

- User account creation w/ email verification
- User "group" creation, with admin privaledges for the "group creator"
- Ability for the admin to invite users via email to join a specific group
- The ability for a user to create a "tool listing" that specifies some text and a picture of the tool that they are willing to lend to other users
- The ability for members of a group to view tool listings across all the groups they are a part of

This website ought to be: 

- Accessable via phone browsers. I don't want an app that needs to be installed (yet) - I just want the website to be very mobile friendly. 
- Hosted in the cloud in as cheap and standard a way possible - minimizing maintenance complexity

## Architecture

- The frontend will be Next.js + Tailwind CSS
- The backend will be Supabase
	- group membership will be implemented using row-based auth
- The site will be hosted on Vercel

## Work log : 

## Phase 1: Project Initialization & Setup
- [x] **1. Initialize Next.js Project**: Create a new Next.js app with TypeScript and Tailwind CSS. (Completed: 2026-01-23)
- [x] **2. Setup Supabase Project**: Initialize a new Supabase project (Auth, Database, Storage). (Completed: 2026-01-23)
- [x] **3. Configure Environment**: Connect the Next.js app to Supabase using environment variables. (Completed: 2026-01-23)
- [x] **4. Deployment Pipeline**: Set up the initial deployment to Vercel to ensure CI/CD from the start. (Completed: 2026-01-23)

## Phase 2: Database & Security (Supabase)
- [x] **5. Database Schema Design**: (Completed: 2026-01-23)
    *   `profiles`: Link to `auth.users`, store user details.
    *   `groups`: Store group info (name, admin_id).
    *   `group_members`: Link users to groups (user_id, group_id, role).
    *   `tools`: Store tool listings (name, description, image_url, owner_id, group_id).
- [x] **6. Row Level Security (RLS)**: (Completed: 2026-01-23)
    *   Implement policies so users can only see tools in groups they belong to.
    *   Implement policies for group admins to manage members.

## Phase 3: Core Features - Backend & Integration
- [x] **7. Authentication**: Implement Sign Up (with email verification flow), Sign In, and Sign Out. (Completed: 2026-01-23)
- [x] **8. Image Storage**: Configure a Supabase Storage bucket for tool images with appropriate access rules. (Completed: 2026-01-23)
- [x] **9. Group Management Logic**: (Completed: 2026-01-23)
    *   [x] Function to create a group. (Completed: 2026-01-23)
    *   [x] Logic for inviting users (via email). (Completed: 2026-01-23)
    *   [x] Logic for accepting invites/joining groups. (Completed: 2026-01-23)
- [x] **10. Tool Management Logic**: Functions to create, read, update, and delete tool listings. (Completed: 2026-01-23)

## Phase 4: Frontend Implementation (Mobile-First)
- [x] **11. Authentication UI**: Login and Registration pages. (Completed: 2026-01-23)
- [x] **12. User Dashboard**: A feed displaying tools from all groups the user is part of. (Completed: 2026-01-23)
- [x] **13. Create Listing UI**: A mobile-friendly form to upload a photo and add text for a tool. (Completed: 2026-01-23)
- [x] **14. Group Management UI**: (Completed: 2026-01-23)
    *   [x] Create Group page. (Completed: 2026-01-23)
    *   [x] Admin view to invite members. (Completed: 2026-01-23)
- [x] **15. Responsiveness Check**: Verify all pages look and work well on mobile viewports. (Completed: 2026-01-23)

## Phase 5: Final Polish
- [x] **16. End-to-End Testing**: Verify the flow of creating a user -> creating a group -> inviting a user -> listing a tool -> second user seeing the tool. (Completed: 2026-01-23)

---

# Next Round: Feature Enhancements

## Phase 6: Borrowing & Engagement
- [ ] **17. Tool Availability Status**: Add ability to mark tools as "Available" or "Borrowed".
- [ ] **18. Borrowing Flow**: Request system where users can ask to borrow a tool, and owners approve/deny.
- [ ] **19. Search & Filter**: Filter dashboard by specific groups or search for tools by name.
- [ ] **20. User Profiles**: Page to edit full name and avatar.
- [ ] **21. Email Notifications**: Integrate with a provider (e.g., Resend) to send real emails for invites and borrow requests.
- [ ] **22. Admin Tools**: Allow group admins to remove members or delete inappropriate listings.

---

# Work Log

### 2026-01-23
- Initialized `GEMINI.md` with the project roadmap and work items based on `Scope.txt`.
- Initialized Next.js project with TypeScript and Tailwind CSS.
- User initialized Supabase project; created `.env.example` and prepared for environment configuration.
- Installed `@supabase/supabase-js` and `@supabase/auth-helpers-nextjs`.
- Configured environment variables and initialized Supabase client in `src/lib/supabase.ts`.
- Designed database schema and RLS policies; created migration file in `supabase/migrations/20260123_initial_schema.sql`.
- Implemented `AuthContext` provider and wrapped the app layout.
- Created Login/Sign Up page (`src/app/login/page.tsx`) and Auth Callback route (`src/app/auth/callback/route.ts`).
- Created `Dashboard` component (`src/components/Dashboard.tsx`) and updated `src/app/page.tsx`.
- Created backend service for Groups (`src/lib/services/groups.ts`) and "Create Group" page (`src/app/groups/create/page.tsx`).
- Created backend service for Tools (`src/lib/services/tools.ts`) and "Create Listing" page (`src/app/tools/create/page.tsx`).
- Updated `Dashboard` to display tool feed and link to create tools.
- Implemented Group Details page (`src/app/groups/[id]/page.tsx`) with invite functionality.
- Updated `Dashboard` to list user's groups for easy access and added Sign Out functionality.
- Migrated from deprecated `@supabase/auth-helpers-nextjs` to `@supabase/ssr` to fix build errors and ensure future compatibility.
- Fixed infinite recursion in RLS policies using Security Definer functions.
- Resolved RLS issues for tool insertion and verified group-based access control.
- Added Storage RLS policies to allow authenticated uploads.
- Configured GitHub repo and verified Vercel deployment (fixed build error with environment variables).
- MVP Deployed and Verified.


### 2026-01-23 02:00 PM
- Implemented global tool visibility based on shared group membership.
- Added search functionality to the tool dashboard.
- Implemented tool editing and deletion for owners.
- Added owner names and links to user profile pages on tool listings.
- Added editable description field for groups.

### 2026-01-23 02:30 PM
- Added branding image (NamelessJoseph.png) to the login page.
- Added placeholder description text to the login page.
\n### 2026-01-23 03:00 PM\n- Added bio field to user profiles and enabled editing.\n- Refactored dashboard group navigation to use a dedicated 'Manage Groups' page.
\n### 2026-01-23 03:15 PM\n- Updated dashboard buttons: 'List Tool', 'Manage Groups', and 'Manage Profile' are now uniform and grouped in the header.
\n### 2026-01-23 03:30 PM\n- Updated 'Community Tools' header font to Nova Cut.
